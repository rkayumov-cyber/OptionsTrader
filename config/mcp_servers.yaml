# External MCP server connections for supplementary data sources
# These servers provide fallback data when the primary provider
# doesn't support certain endpoints (IV analysis, sentiment, news, etc.)

mcp_servers:
  yahoo_finance:
    name: "Yahoo Finance"
    enabled: true
    command: "python"
    args: ["-m", "yahoo_finance_mcp.server"]
    env: {}
    capabilities: [quote, options, history, news, sentiment, earnings]
    tool_mappings:
      get_quote: "get_stock_info"
      get_option_chain: "get_option_chain"
      get_price_history: "get_historical_stock_prices"
      get_sentiment: "get_recommendations"
      get_news: "get_yahoo_finance_news"
      get_earnings: "get_stock_actions"
      get_financials: "get_financial_statement"
      get_option_expirations: "get_option_expiration_dates"

  alpha_vantage:
    name: "Alpha Vantage"
    enabled: true
    command: "python"
    args: ["-m", "uv", "tool", "run", "av-mcp", "${ALPHA_VANTAGE_API_KEY}"]
    env:
      ALPHA_VANTAGE_API_KEY: "${ALPHA_VANTAGE_API_KEY}"
    capabilities: [quote, history, news, sentiment, economic_data, commodities, options, technicals]
    # AV uses a TOOL_CALL wrapper â€” tool_mappings map our keys to AV sub-tool names
    tool_call_wrapper: "TOOL_CALL"
    tool_mappings:
      get_quote: "GLOBAL_QUOTE"
      get_price_history: "TIME_SERIES_DAILY"
      get_news: "NEWS_SENTIMENT"
      get_sentiment: "NEWS_SENTIMENT"
      get_option_chain: "REALTIME_OPTIONS"
      get_top_movers: "TOP_GAINERS_LOSERS"
      get_earnings_transcript: "EARNINGS_CALL_TRANSCRIPT"
      get_insider_transactions: "INSIDER_TRANSACTIONS"
      get_company_overview: "OVERVIEW"
      get_income_statement: "INCOME_STATEMENT"
      get_balance_sheet: "BALANCE_SHEET"
      get_cash_flow: "CASH_FLOW"
    # Default: rename generic 'ticker' arg to AV's 'symbol'
    param_mappings:
      ticker: symbol
    # Per-tool overrides where AV uses a different param name
    tool_param_overrides:
      NEWS_SENTIMENT:
        ticker: tickers

  twelve_data:
    name: "Twelve Data"
    enabled: true
    command: "python"
    args: ["-m", "mcp_server_twelve_data", "-k", "${TWELVE_DATA_API_KEY}", "-n", "50"]
    env:
      TWELVE_DATA_API_KEY: "${TWELVE_DATA_API_KEY}"
    capabilities: [quote, history, sentiment, earnings, technicals]
    # Twelve Data tools require args nested under "params" key
    param_wrapper: "params"
    param_mappings:
      ticker: symbol
    tool_mappings:
      get_quote: "GetQuote"
      get_price_history: "GetTimeSeries"
      get_sentiment: "GetRecommendations"
      get_earnings: "GetEarnings"
      get_company_overview: "GetProfile"
      get_statistics: "GetStatistics"
      get_income_statement: "GetIncomeStatement"
      get_balance_sheet: "GetBalanceSheet"
      get_cash_flow: "GetCashFlow"

  fred:
    name: "FRED Economic Data"
    enabled: false  # requires FRED_API_KEY env var
    command: "npx"
    args: ["@stefanoamorelli/fred-mcp-server"]
    env:
      FRED_API_KEY: "${FRED_API_KEY}"
    capabilities: [economic_data, rates]
    tool_mappings:
      get_economic_series: "fred_get_series"

fallback_priority:
  quote: [yahoo_finance, twelve_data, alpha_vantage]
  options: [yahoo_finance, alpha_vantage]
  history: [yahoo_finance, twelve_data, alpha_vantage]
  sentiment: [yahoo_finance, twelve_data, alpha_vantage]
  news: [alpha_vantage, yahoo_finance]
  earnings: [twelve_data, yahoo_finance]
  economic_data: [fred]
